<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Real Data Analysis â€¢ prml</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Real Data Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prml</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/my-vignette.html">Real Data Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/YunranChen/prml">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Real Data Analysis</h1>
                        <h4 class="author">Yunran Chen</h4>
            
            <h4 class="date">2019-04-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/YunranChen/prml/blob/master/vignettes/my-vignette.Rmd"><code>vignettes/my-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>my-vignette.Rmd</code></div>

    </div>

    
    
<p><strong>prml</strong> is designed to implement the PRML classifier and PRML filter proposed by Chen and Tokdar (2019).</p>
<p>PRML classifier is a hypothesis testing for different types of Poisson mixtures. PRML filter is a hypothesis testing for screening out data with overdispersed Poisson. PRML classifier take second order stochasticity into consideration, helping neuroscientists to classify the activation patterns that a single neuron exhibits when preserving information from multiple stimuli. PRML filter contributes to avoid mistaking trial-to-trial variation as second order stochasticity.</p>
<p>For real data anlaysis, we only need to use function <code><a href="../reference/prml_tests.html">prml_tests()</a></code>, which take the <span class="math inline">\(\{Y^A,Y^B,Y^{AB}\}\)</span> as input. <span class="math inline">\(\{Y^A,Y^B,Y^{AB}\}\)</span> represent spike count data coming from the repeated trials under condition <span class="math inline">\(\{A,B,AB\}\)</span> (single-stimulus trial A, B and dual-stimuli trial AB). We provide a sample code on</p>
<ul>
<li>how to extract the spike count triplets from the raw data;</li>
<li>how to use function <code><a href="../reference/prml_tests.html">prml_tests()</a></code>;</li>
<li>simple data visualization on the result.</li>
</ul>
<p>If you want to obtain density estimation of the mixing density, replace <code><a href="../reference/prml_tests.html">prml_tests()</a></code> with <code><a href="../reference/prml_tests_f.html">prml_tests_f()</a></code> in the sample code.</p>
<div id="dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#dataset" class="anchor"></a>Dataset</h2>
<p>The raw data is stored as .txt file pairs. One stores the experiment condition and corresponding condition id. The other stores the timepoints of spikes under experiment specified by the id. The raw data included within a pair of .txt files contains multiple experiment triplets. And there are multiple pairs within the folder.</p>
<p>The following data shows:</p>
<ul>
<li>
<code>prml.from.tri()</code>: extract spike count triplets from a pair of .txt raw data under specified condition; and apply <code><a href="../reference/prml_tests.html">prml_tests()</a></code> for each spike count triplet.</li>
<li>
<code>prml.from.fname()</code>: apply <code>prml.from.tri()</code> under all possible conditions within a pair of .txt raw data.</li>
<li>apply <code>prml.from.fname()</code> for all pairs of .txt raw data within a folder. save the output as a .txt file.</li>
</ul>
</div>
<div id="preparation" class="section level2">
<h2 class="hasAnchor">
<a href="#preparation" class="anchor"></a>Preparation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># devtools::install_github("yunranchen/prml")</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(prml)</a></code></pre></div>
</div>
<div id="example-for-applying-prml_tests" class="section level2">
<h2 class="hasAnchor">
<a href="#example-for-applying-prml_tests" class="anchor"></a>Example for applying <code><a href="../reference/prml_tests.html">prml_tests()</a></code>
</h2>
<p>The function <code>prml.from.tri()</code> is for:</p>
<ul>
<li>Under specified triplets condition <span class="math inline">\(\{A,B,AB\}\)</span>, extract spike count triplets from two dataframes <code>trials</code> (storing information of triplets condition) and <code>spiketimes</code> (storing the timepoints of spikes within trials).</li>
<li>Apply <code>prml_test()</code> on the spike count triplets.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">prml.from.tri &lt;-<span class="st"> </span><span class="cf">function</span>(trials, spiketimes, <span class="dt">frq =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1100</span>, <span class="dv">742</span>),</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">                       <span class="dt">pos =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">24</span>, <span class="dv">-6</span>), <span class="dt">on.reward =</span> <span class="ot">TRUE</span>, <span class="dt">start.time =</span> <span class="dv">0</span>, <span class="dt">end.time =</span> <span class="dv">600</span>,</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">                       <span class="dt">match.level =</span> <span class="ot">FALSE</span>, <span class="dt">AB.eqlevel =</span> <span class="ot">FALSE</span>, <span class="dt">go.by.soff =</span> <span class="ot">FALSE</span>, ...){</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attach">attach</a></span>(trials)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attach">attach</a></span>(spiketimes)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8"></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">  timestamps &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/split">split</a></span>(TIMES, TRIAL2)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">  ntrials &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(timestamps)</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">  trial.id &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(timestamps)) </a>
<a class="sourceLine" id="cb2-12" data-line-number="12"></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">  ix1 &lt;-<span class="st"> </span>TASKID <span class="op">==</span><span class="st"> </span><span class="dv">8</span> <span class="op">&amp;</span><span class="st"> </span>A_FREQ <span class="op">==</span><span class="st"> </span>frq[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>XA <span class="op">==</span><span class="st"> </span>pos[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">  ix2 &lt;-<span class="st"> </span>TASKID <span class="op">==</span><span class="st"> </span><span class="dv">8</span> <span class="op">&amp;</span><span class="st"> </span>A_FREQ <span class="op">==</span><span class="st"> </span>frq[<span class="dv">2</span>] <span class="op">&amp;</span><span class="st"> </span>XA <span class="op">==</span><span class="st"> </span>pos[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb2-15" data-line-number="15">  ix3 &lt;-<span class="st"> </span>TASKID <span class="op">==</span><span class="st"> </span><span class="dv">12</span> <span class="op">&amp;</span><span class="st"> </span>(A_FREQ <span class="op">==</span><span class="st"> </span>frq[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>B_FREQ <span class="op">==</span><span class="st"> </span>frq[<span class="dv">2</span>] <span class="op">&amp;</span><span class="st"> </span>XA <span class="op">==</span><span class="st"> </span>pos[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>XB <span class="op">==</span><span class="st"> </span>pos[<span class="dv">2</span>]) <span class="op">|</span><span class="st"> </span>(A_FREQ <span class="op">==</span><span class="st"> </span>frq[<span class="dv">2</span>] <span class="op">&amp;</span><span class="st"> </span>B_FREQ <span class="op">==</span><span class="st"> </span>frq[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>XA <span class="op">==</span><span class="st"> </span>pos[<span class="dv">2</span>] <span class="op">&amp;</span><span class="st"> </span>XB <span class="op">==</span><span class="st"> </span>pos[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb2-16" data-line-number="16"></a>
<a class="sourceLine" id="cb2-17" data-line-number="17">  <span class="cf">if</span>(on.reward){</a>
<a class="sourceLine" id="cb2-18" data-line-number="18">    ix1 &lt;-<span class="st"> </span>ix1 <span class="op">&amp;</span><span class="st"> </span>REWARD <span class="op">==</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19">    ix2 &lt;-<span class="st"> </span>ix2 <span class="op">&amp;</span><span class="st"> </span>REWARD <span class="op">==</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20">    ix3 &lt;-<span class="st"> </span>ix3 <span class="op">&amp;</span><span class="st"> </span>REWARD <span class="op">==</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21">  }</a>
<a class="sourceLine" id="cb2-22" data-line-number="22"></a>
<a class="sourceLine" id="cb2-23" data-line-number="23">  blev &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(B_LEVEL[ix3]))</a>
<a class="sourceLine" id="cb2-24" data-line-number="24">  targ.lev &lt;-<span class="st"> </span>blev[blev <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</a>
<a class="sourceLine" id="cb2-25" data-line-number="25">  lev &lt;-<span class="st"> "*"</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26">  <span class="cf">if</span>(match.level) {</a>
<a class="sourceLine" id="cb2-27" data-line-number="27">    <span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(targ.lev) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb2-28" data-line-number="28">      targ.lev &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(targ.lev)</a>
<a class="sourceLine" id="cb2-29" data-line-number="29">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/warning">warning</a></span>(<span class="st">"Multiple single sound levels, choosing largest one"</span>)</a>
<a class="sourceLine" id="cb2-30" data-line-number="30">    }</a>
<a class="sourceLine" id="cb2-31" data-line-number="31">    ix1 &lt;-<span class="st"> </span>ix1 <span class="op">&amp;</span><span class="st"> </span>A_LEVEL <span class="op">==</span><span class="st"> </span>targ.lev</a>
<a class="sourceLine" id="cb2-32" data-line-number="32">    ix2 &lt;-<span class="st"> </span>ix2 <span class="op">&amp;</span><span class="st"> </span>A_LEVEL <span class="op">==</span><span class="st"> </span>targ.lev</a>
<a class="sourceLine" id="cb2-33" data-line-number="33">    lev &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(targ.lev)</a>
<a class="sourceLine" id="cb2-34" data-line-number="34">  }</a>
<a class="sourceLine" id="cb2-35" data-line-number="35"></a>
<a class="sourceLine" id="cb2-36" data-line-number="36">  <span class="cf">if</span>(AB.eqlevel) ix3 &lt;-<span class="st"> </span>ix3 <span class="op">&amp;</span><span class="st"> </span>(A_LEVEL <span class="op">==</span><span class="st"> </span>B_LEVEL)</a>
<a class="sourceLine" id="cb2-37" data-line-number="37"></a>
<a class="sourceLine" id="cb2-38" data-line-number="38">  sing1 &lt;-<span class="st"> </span>trials[ix1, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb2-39" data-line-number="39">  sing2 &lt;-<span class="st"> </span>trials[ix2, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb2-40" data-line-number="40">  duplx &lt;-<span class="st"> </span>trials[ix3, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb2-41" data-line-number="41">  success &lt;-<span class="st"> </span>REWARD[ix3]</a>
<a class="sourceLine" id="cb2-42" data-line-number="42"></a>
<a class="sourceLine" id="cb2-43" data-line-number="43">  <span class="cf">if</span>(go.by.soff) end.time &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(SOFF[ix1 <span class="op">|</span><span class="st"> </span>ix2 <span class="op">|</span><span class="st"> </span>ix3])</a>
<a class="sourceLine" id="cb2-44" data-line-number="44"></a>
<a class="sourceLine" id="cb2-45" data-line-number="45">  spike.counter &lt;-<span class="st"> </span><span class="cf">function</span>(jj){</a>
<a class="sourceLine" id="cb2-46" data-line-number="46">    jj1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/match">match</a></span>(jj, trial.id)</a>
<a class="sourceLine" id="cb2-47" data-line-number="47">    spks &lt;-<span class="st"> </span>timestamps[[jj1]]</a>
<a class="sourceLine" id="cb2-48" data-line-number="48">    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spks <span class="op">&gt;</span><span class="st"> </span>start.time <span class="op">&amp;</span><span class="st"> </span>spks <span class="op">&lt;</span><span class="st"> </span>end.time))</a>
<a class="sourceLine" id="cb2-49" data-line-number="49">  }</a>
<a class="sourceLine" id="cb2-50" data-line-number="50"></a>
<a class="sourceLine" id="cb2-51" data-line-number="51">  Acounts &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(sing1, spike.counter)</a>
<a class="sourceLine" id="cb2-52" data-line-number="52">  Bcounts &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(sing2, spike.counter)</a>
<a class="sourceLine" id="cb2-53" data-line-number="53">  ABcounts &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(duplx, spike.counter)</a>
<a class="sourceLine" id="cb2-54" data-line-number="54"></a>
<a class="sourceLine" id="cb2-55" data-line-number="55">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/detach">detach</a></span>(trials)</a>
<a class="sourceLine" id="cb2-56" data-line-number="56">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/detach">detach</a></span>(spiketimes)</a>
<a class="sourceLine" id="cb2-57" data-line-number="57"></a>
<a class="sourceLine" id="cb2-58" data-line-number="58"></a>
<a class="sourceLine" id="cb2-59" data-line-number="59">  s1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(frq[<span class="dv">1</span>],<span class="st">"Hz "</span>,pos[<span class="dv">1</span>],<span class="st">"deg "</span>,lev,<span class="st">"Db "</span>, <span class="dt">sep =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb2-60" data-line-number="60">  s2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(frq[<span class="dv">2</span>],<span class="st">"Hz "</span>,pos[<span class="dv">2</span>],<span class="st">"deg "</span>,lev,<span class="st">"Db "</span>, <span class="dt">sep =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb2-61" data-line-number="61">  dp &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Duplex: "</span>, lev, <span class="st">"Db "</span>, <span class="dt">sep =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb2-62" data-line-number="62">  </a>
<a class="sourceLine" id="cb2-63" data-line-number="63">  res=<span class="kw"><a href="../reference/prml_tests.html">prml_tests</a></span>(<span class="dt">xA=</span>Acounts, <span class="dt">xB=</span>Bcounts, <span class="dt">xAB=</span>ABcounts, <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(s1, s2, dp),<span class="dt">e=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb2-64" data-line-number="64"></a>
<a class="sourceLine" id="cb2-65" data-line-number="65">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(res)</a>
<a class="sourceLine" id="cb2-66" data-line-number="66">}</a></code></pre></div>
<p>The function <code>prml.from.fname()</code> is for:</p>
<ul>
<li>Find all possible conditions within a pair of .txt files</li>
<li>apply <code>prml.from.tri()</code> under all possible triplets</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">prml.from.fname &lt;-<span class="st"> </span><span class="cf">function</span>(fname, <span class="dt">data.path =</span> <span class="st">"Data"</span>, <span class="dt">on.reward =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">                   <span class="dt">match.level =</span> <span class="ot">FALSE</span>, <span class="dt">AB.eqlevel =</span> <span class="ot">FALSE</span>, <span class="dt">outfile =</span> <span class="st">""</span>,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">                   <span class="dt">start =</span> <span class="dv">0</span>, <span class="dt">end =</span> <span class="dv">600</span>, <span class="dt">remove.zeros =</span> <span class="ot">FALSE</span>){</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  infile1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(data.path, <span class="st">"/JA/"</span>, fname, <span class="st">".txt"</span>, <span class="dt">sep =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  </a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  trials &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/read.table">read.table</a></span>(infile1, <span class="dt">col.names =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"TRIAL"</span>, <span class="st">"TASKID"</span>, <span class="st">"A_FREQ"</span>, <span class="st">"B_FREQ"</span>, <span class="st">"XA"</span>, <span class="st">"XB"</span>, <span class="st">"REWARD"</span>, <span class="st">"A_LEVEL"</span>, <span class="st">"B_LEVEL"</span>))</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  infile2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(data.path, <span class="st">"/JA/"</span>, fname, <span class="st">"_spiketimes.txt"</span>, <span class="dt">sep =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">  </a>
<a class="sourceLine" id="cb3-11" data-line-number="11">  spiketimes &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/read.table">read.table</a></span>(infile2, <span class="dt">col.names =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"TRIAL2"</span>, <span class="st">"TIMES"</span>))</a>
<a class="sourceLine" id="cb3-12" data-line-number="12"></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">  FREQS &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(trials<span class="op">$</span>A_FREQ, trials<span class="op">$</span>B_FREQ))</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">  alt.freq &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>(FREQS[FREQS <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>FREQS <span class="op">!=</span><span class="st"> </span><span class="dv">742</span>])</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">  alt.pos &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">24</span>, <span class="dv">-6</span>, <span class="dv">6</span>, <span class="dv">24</span>)</a>
<a class="sourceLine" id="cb3-16" data-line-number="16"></a>
<a class="sourceLine" id="cb3-17" data-line-number="17">  <span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfcol =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(alt.freq),<span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb3-18" data-line-number="18"></a>
<a class="sourceLine" id="cb3-19" data-line-number="19">  <span class="cf">for</span>(fr <span class="cf">in</span> alt.freq){</a>
<a class="sourceLine" id="cb3-20" data-line-number="20">    <span class="cf">for</span>(po <span class="cf">in</span> alt.pos){</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/try">try</a></span>({lbf &lt;-<span class="kw">prml.from.tri</span>(trials, spiketimes, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(fr, <span class="dv">742</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(po, <span class="dv">-144</span><span class="op">/</span>po), on.reward, start, end, match.level, AB.eqlevel, <span class="dt">go.by.soff=</span><span class="ot">FALSE</span>, remove.zeros)<span class="op">%&gt;%</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(.);</a>
<a class="sourceLine" id="cb3-22" data-line-number="22">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(fname, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(fr, po, lbf), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, <span class="dt">file =</span> outfile, <span class="dt">append =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb3-23" data-line-number="23">      })</a>
<a class="sourceLine" id="cb3-24" data-line-number="24">    }</a>
<a class="sourceLine" id="cb3-25" data-line-number="25">  }</a>
<a class="sourceLine" id="cb3-26" data-line-number="26">}</a></code></pre></div>
<p>The foor loop is for:</p>
<ul>
<li>apply <code>prml.from.fname()</code> for all pairs of .txt files within the folder.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">ja.fnames=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/scan">scan</a></span>(<span class="st">"JA230_list_randomly_interleaved.txt"</span>, <span class="st">"a"</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="cf">for</span> (ja.name <span class="cf">in</span> ja.fnames){</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/try">try</a></span>(<span class="kw">prml.from.fname</span>(ja.name, <span class="dt">data.path =</span> <span class="st">"Data"</span>, <span class="dt">on.reward =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">              <span class="dt">match.level =</span> <span class="ot">FALSE</span>, <span class="dt">AB.eqlevel =</span> <span class="ot">FALSE</span>, <span class="dt">outfile =</span> <span class="st">"JA.txt"</span>,</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">              <span class="dt">start =</span> <span class="dv">0</span>, <span class="dt">end =</span> <span class="dv">600</span>, <span class="dt">remove.zeros =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">}</a></code></pre></div>
</div>
<div id="example-for-applying-prml_tests_f" class="section level2">
<h2 class="hasAnchor">
<a href="#example-for-applying-prml_tests_f" class="anchor"></a>Example for applying <code><a href="../reference/prml_tests_f.html">prml_tests_f()</a></code>
</h2>
<ul>
<li>
<code>prml.from.tri.f()</code>: replace <code><a href="../reference/prml_tests.html">prml_tests()</a></code> in <code>prml.from.tri()</code> with <code><a href="../reference/prml_tests_f.html">prml_tests_f()</a></code>
</li>
<li>
<code>prml.from.fname.f()</code>: apply <code>prml.from.tri.f()</code> and output the density estimation in a separate .txt file.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">prml.from.tri.f &lt;-<span class="st"> </span><span class="cf">function</span>(trials, spiketimes, <span class="dt">frq =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1100</span>, <span class="dv">742</span>),</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">                       <span class="dt">pos =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">24</span>, <span class="dv">-6</span>), <span class="dt">on.reward =</span> <span class="ot">TRUE</span>, <span class="dt">start.time =</span> <span class="dv">0</span>, <span class="dt">end.time =</span> <span class="dv">600</span>,</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">                       <span class="dt">match.level =</span> <span class="ot">FALSE</span>, <span class="dt">AB.eqlevel =</span> <span class="ot">FALSE</span>, <span class="dt">go.by.soff =</span> <span class="ot">FALSE</span>, ...){</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attach">attach</a></span>(trials)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attach">attach</a></span>(spiketimes)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">  timestamps &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/split">split</a></span>(TIMES, TRIAL2)</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">  ntrials &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(timestamps)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">  trial.id &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(timestamps)) <span class="co">## same as unique(TRIAL2)</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12">  ix1 &lt;-<span class="st"> </span>TASKID <span class="op">==</span><span class="st"> </span><span class="dv">8</span> <span class="op">&amp;</span><span class="st"> </span>A_FREQ <span class="op">==</span><span class="st"> </span>frq[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>XA <span class="op">==</span><span class="st"> </span>pos[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">  ix2 &lt;-<span class="st"> </span>TASKID <span class="op">==</span><span class="st"> </span><span class="dv">8</span> <span class="op">&amp;</span><span class="st"> </span>A_FREQ <span class="op">==</span><span class="st"> </span>frq[<span class="dv">2</span>] <span class="op">&amp;</span><span class="st"> </span>XA <span class="op">==</span><span class="st"> </span>pos[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">  ix3 &lt;-<span class="st"> </span>TASKID <span class="op">==</span><span class="st"> </span><span class="dv">12</span> <span class="op">&amp;</span><span class="st"> </span>(A_FREQ <span class="op">==</span><span class="st"> </span>frq[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>B_FREQ <span class="op">==</span><span class="st"> </span>frq[<span class="dv">2</span>] <span class="op">&amp;</span><span class="st"> </span>XA <span class="op">==</span><span class="st"> </span>pos[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>XB <span class="op">==</span><span class="st"> </span>pos[<span class="dv">2</span>]) <span class="op">|</span><span class="st"> </span>(A_FREQ <span class="op">==</span><span class="st"> </span>frq[<span class="dv">2</span>] <span class="op">&amp;</span><span class="st"> </span>B_FREQ <span class="op">==</span><span class="st"> </span>frq[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>XA <span class="op">==</span><span class="st"> </span>pos[<span class="dv">2</span>] <span class="op">&amp;</span><span class="st"> </span>XB <span class="op">==</span><span class="st"> </span>pos[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb5-15" data-line-number="15"></a>
<a class="sourceLine" id="cb5-16" data-line-number="16">  <span class="cf">if</span>(on.reward){</a>
<a class="sourceLine" id="cb5-17" data-line-number="17">    ix1 &lt;-<span class="st"> </span>ix1 <span class="op">&amp;</span><span class="st"> </span>REWARD <span class="op">==</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18">    ix2 &lt;-<span class="st"> </span>ix2 <span class="op">&amp;</span><span class="st"> </span>REWARD <span class="op">==</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19">    ix3 &lt;-<span class="st"> </span>ix3 <span class="op">&amp;</span><span class="st"> </span>REWARD <span class="op">==</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20">  }</a>
<a class="sourceLine" id="cb5-21" data-line-number="21"></a>
<a class="sourceLine" id="cb5-22" data-line-number="22">  blev &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(B_LEVEL[ix3]))</a>
<a class="sourceLine" id="cb5-23" data-line-number="23">  targ.lev &lt;-<span class="st"> </span>blev[blev <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</a>
<a class="sourceLine" id="cb5-24" data-line-number="24">  lev &lt;-<span class="st"> "*"</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25">  <span class="cf">if</span>(match.level) {</a>
<a class="sourceLine" id="cb5-26" data-line-number="26">    <span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(targ.lev) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb5-27" data-line-number="27">      targ.lev &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(targ.lev)</a>
<a class="sourceLine" id="cb5-28" data-line-number="28">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/warning">warning</a></span>(<span class="st">"Multiple single sound levels, choosing largest one"</span>)</a>
<a class="sourceLine" id="cb5-29" data-line-number="29">    }</a>
<a class="sourceLine" id="cb5-30" data-line-number="30">    ix1 &lt;-<span class="st"> </span>ix1 <span class="op">&amp;</span><span class="st"> </span>A_LEVEL <span class="op">==</span><span class="st"> </span>targ.lev</a>
<a class="sourceLine" id="cb5-31" data-line-number="31">    ix2 &lt;-<span class="st"> </span>ix2 <span class="op">&amp;</span><span class="st"> </span>A_LEVEL <span class="op">==</span><span class="st"> </span>targ.lev</a>
<a class="sourceLine" id="cb5-32" data-line-number="32">    lev &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(targ.lev)</a>
<a class="sourceLine" id="cb5-33" data-line-number="33">  }</a>
<a class="sourceLine" id="cb5-34" data-line-number="34"></a>
<a class="sourceLine" id="cb5-35" data-line-number="35">  <span class="cf">if</span>(AB.eqlevel) ix3 &lt;-<span class="st"> </span>ix3 <span class="op">&amp;</span><span class="st"> </span>(A_LEVEL <span class="op">==</span><span class="st"> </span>B_LEVEL)</a>
<a class="sourceLine" id="cb5-36" data-line-number="36"></a>
<a class="sourceLine" id="cb5-37" data-line-number="37">  sing1 &lt;-<span class="st"> </span>trials[ix1, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb5-38" data-line-number="38">  sing2 &lt;-<span class="st"> </span>trials[ix2, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb5-39" data-line-number="39">  duplx &lt;-<span class="st"> </span>trials[ix3, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb5-40" data-line-number="40">  success &lt;-<span class="st"> </span>REWARD[ix3]</a>
<a class="sourceLine" id="cb5-41" data-line-number="41"></a>
<a class="sourceLine" id="cb5-42" data-line-number="42">  <span class="cf">if</span>(go.by.soff) end.time &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(SOFF[ix1 <span class="op">|</span><span class="st"> </span>ix2 <span class="op">|</span><span class="st"> </span>ix3])</a>
<a class="sourceLine" id="cb5-43" data-line-number="43"></a>
<a class="sourceLine" id="cb5-44" data-line-number="44">  spike.counter &lt;-<span class="st"> </span><span class="cf">function</span>(jj){</a>
<a class="sourceLine" id="cb5-45" data-line-number="45">    jj1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/match">match</a></span>(jj, trial.id)</a>
<a class="sourceLine" id="cb5-46" data-line-number="46">    spks &lt;-<span class="st"> </span>timestamps[[jj1]]</a>
<a class="sourceLine" id="cb5-47" data-line-number="47">    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spks <span class="op">&gt;</span><span class="st"> </span>start.time <span class="op">&amp;</span><span class="st"> </span>spks <span class="op">&lt;</span><span class="st"> </span>end.time))</a>
<a class="sourceLine" id="cb5-48" data-line-number="48">  }</a>
<a class="sourceLine" id="cb5-49" data-line-number="49"></a>
<a class="sourceLine" id="cb5-50" data-line-number="50">  Acounts &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(sing1, spike.counter)</a>
<a class="sourceLine" id="cb5-51" data-line-number="51">  Bcounts &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(sing2, spike.counter)</a>
<a class="sourceLine" id="cb5-52" data-line-number="52">  ABcounts &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(duplx, spike.counter)</a>
<a class="sourceLine" id="cb5-53" data-line-number="53"></a>
<a class="sourceLine" id="cb5-54" data-line-number="54">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/detach">detach</a></span>(trials)</a>
<a class="sourceLine" id="cb5-55" data-line-number="55">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/detach">detach</a></span>(spiketimes)</a>
<a class="sourceLine" id="cb5-56" data-line-number="56"></a>
<a class="sourceLine" id="cb5-57" data-line-number="57"></a>
<a class="sourceLine" id="cb5-58" data-line-number="58">  s1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(frq[<span class="dv">1</span>],<span class="st">"Hz "</span>,pos[<span class="dv">1</span>],<span class="st">"deg "</span>,lev,<span class="st">"Db "</span>, <span class="dt">sep =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb5-59" data-line-number="59">  s2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(frq[<span class="dv">2</span>],<span class="st">"Hz "</span>,pos[<span class="dv">2</span>],<span class="st">"deg "</span>,lev,<span class="st">"Db "</span>, <span class="dt">sep =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb5-60" data-line-number="60">  dp &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Duplex: "</span>, lev, <span class="st">"Db "</span>, <span class="dt">sep =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb5-61" data-line-number="61">  res=<span class="kw"><a href="../reference/prml_tests_f.html">prml_tests_f</a></span>(<span class="dt">xA=</span>Acounts, <span class="dt">xB=</span>Bcounts, <span class="dt">xAB=</span>ABcounts, <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(s1, s2, dp),<span class="dt">e=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb5-62" data-line-number="62">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(res)</a>
<a class="sourceLine" id="cb5-63" data-line-number="63">}</a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">prml.from.fname.f &lt;-<span class="st"> </span><span class="cf">function</span>(fname, <span class="dt">data.path =</span> <span class="st">"Data"</span>, <span class="dt">on.reward =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">                        <span class="dt">match.level =</span> <span class="ot">FALSE</span>, <span class="dt">AB.eqlevel =</span> <span class="ot">FALSE</span>, <span class="dt">outfile =</span> <span class="st">""</span>,</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">                        <span class="dt">start =</span> <span class="dv">0</span>, <span class="dt">end =</span> <span class="dv">600</span>, <span class="dt">remove.zeros =</span> <span class="ot">FALSE</span>){</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  infile1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(data.path, <span class="st">"/JA/"</span>, fname, <span class="st">".txt"</span>, <span class="dt">sep =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  </a>
<a class="sourceLine" id="cb6-7" data-line-number="7">  trials &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/read.table">read.table</a></span>(infile1, <span class="dt">col.names =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"TRIAL"</span>, <span class="st">"TASKID"</span>, <span class="st">"A_FREQ"</span>, <span class="st">"B_FREQ"</span>, <span class="st">"XA"</span>, <span class="st">"XB"</span>, <span class="st">"REWARD"</span>, <span class="st">"A_LEVEL"</span>, <span class="st">"B_LEVEL"</span>))</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"></a>
<a class="sourceLine" id="cb6-9" data-line-number="9">  infile2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(data.path, <span class="st">"/JA/"</span>, fname, <span class="st">"_spiketimes.txt"</span>, <span class="dt">sep =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  spiketimes &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/read.table">read.table</a></span>(infile2, <span class="dt">col.names =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"TRIAL2"</span>, <span class="st">"TIMES"</span>))</a>
<a class="sourceLine" id="cb6-11" data-line-number="11"></a>
<a class="sourceLine" id="cb6-12" data-line-number="12">  FREQS &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(trials<span class="op">$</span>A_FREQ, trials<span class="op">$</span>B_FREQ))</a>
<a class="sourceLine" id="cb6-13" data-line-number="13">  alt.freq &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>(FREQS[FREQS <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>FREQS <span class="op">!=</span><span class="st"> </span><span class="dv">742</span>])</a>
<a class="sourceLine" id="cb6-14" data-line-number="14">  alt.pos &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">24</span>, <span class="dv">-6</span>, <span class="dv">6</span>, <span class="dv">24</span>)</a>
<a class="sourceLine" id="cb6-15" data-line-number="15"></a>
<a class="sourceLine" id="cb6-16" data-line-number="16">  <span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfcol =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(alt.freq),<span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb6-17" data-line-number="17"></a>
<a class="sourceLine" id="cb6-18" data-line-number="18">  <span class="cf">for</span>(fr <span class="cf">in</span> alt.freq){</a>
<a class="sourceLine" id="cb6-19" data-line-number="19">    <span class="cf">for</span>(po <span class="cf">in</span> alt.pos){</a>
<a class="sourceLine" id="cb6-20" data-line-number="20">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/try">try</a></span>({lbf &lt;-<span class="kw">prml.from.tri.f</span>(trials, spiketimes, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(fr, <span class="dv">742</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(po, <span class="dv">-144</span><span class="op">/</span>po),</a>
<a class="sourceLine" id="cb6-21" data-line-number="21">                            on.reward, start, end, match.level, AB.eqlevel,</a>
<a class="sourceLine" id="cb6-22" data-line-number="22">                            remove.zeros);</a>
<a class="sourceLine" id="cb6-23" data-line-number="23">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(fname, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(fr, po, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(lbf<span class="op">$</span>out1)), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, <span class="dt">file =</span> outfile, <span class="dt">append =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb6-24" data-line-number="24">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(fname, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(fr, po, lbf<span class="op">$</span>out2<span class="op">$</span>mix_pf), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, <span class="dt">file =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"mix"</span>,outfile), <span class="dt">append =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb6-25" data-line-number="25">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(fname, <span class="st">"int"</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(fr, po, lbf<span class="op">$</span>out2<span class="op">$</span>int_pf), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, <span class="dt">file =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"int_out"</span>,outfile), <span class="dt">append =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb6-26" data-line-number="26">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(fname, <span class="st">"outA"</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(fr, po, lbf<span class="op">$</span>out2<span class="op">$</span>outA_pf), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, <span class="dt">file =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"int_out"</span>,outfile), <span class="dt">append =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb6-27" data-line-number="27">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(fname, <span class="st">"outB"</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(fr, po, lbf<span class="op">$</span>out2<span class="op">$</span>outB_pf), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, <span class="dt">file =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"int_out"</span>,outfile), <span class="dt">append =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb6-28" data-line-number="28">      })</a>
<a class="sourceLine" id="cb6-29" data-line-number="29">    }</a>
<a class="sourceLine" id="cb6-30" data-line-number="30">  }</a>
<a class="sourceLine" id="cb6-31" data-line-number="31">}</a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">ja.fnames=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/scan">scan</a></span>(<span class="st">"JA230_list_randomly_interleaved.txt"</span>, <span class="st">"a"</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="cf">for</span> (ja.name <span class="cf">in</span> ja.fnames){</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/try">try</a></span>(<span class="kw">prml.from.fname.f</span>(ja.name, <span class="dt">data.path =</span> <span class="st">"Data"</span>, <span class="dt">on.reward =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">              <span class="dt">match.level =</span> <span class="ot">FALSE</span>, <span class="dt">AB.eqlevel =</span> <span class="ot">FALSE</span>, <span class="dt">outfile =</span> <span class="st">"JA.txt"</span>,</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">              <span class="dt">start =</span> <span class="dv">0</span>, <span class="dt">end =</span> <span class="dv">600</span>, <span class="dt">remove.zeros =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">}</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#dataset">Dataset</a></li>
      <li><a href="#preparation">Preparation</a></li>
      <li><a href="#example-for-applying-prml_tests">Example for applying <code><a href="--/reference/prml_tests-html">prml_tests()</a></code></a></li>
      <li><a href="#example-for-applying-prml_tests_f">Example for applying <code><a href="--/reference/prml_tests_f-html">prml_tests_f()</a></code></a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
